"""
PROJECT 3 IMPROVEMENT #1 - QUICK REFERENCE CARD
Dynamic Correlation Strength Matrix

Keep this handy while testing and integrating!
"""

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PENALTY LOOKUP TABLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Correlation Type            Strength    Penalty    Emoji   Risk Level
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
DVOA + Matchup             1.5         -7.5%      ğŸ”¥      VERY HIGH
DVOA + GameScript          1.3         -6.5%      ğŸ”¥      VERY HIGH
Matchup + GameScript       1.2         -6.0%      ğŸ”¥      HIGH

Injury + Volume            1.1         -5.5%      âš ï¸      MODERATE
DVOA + Volume              1.0         -5.0%      âš ï¸      MODERATE
Injury + Matchup           0.9         -4.5%      âš ï¸      MODERATE

Trend + Volume             0.7         -3.5%      âš¡      LOW
Trend + Injury             0.6         -3.0%      âš¡      LOW
Variance + Weather         0.5         -2.5%      âš¡      VERY LOW

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FILES CREATED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ scripts/analysis/correlation_detector.py
   âœ… REWRITTEN - Contains CorrelationAnalyzer class
   Key methods: get_correlation_strength(), analyze_parlay_correlations()

ğŸ“„ test_correlation_strength_matrix.py
   âœ… NEW - Comprehensive test suite
   Run: python test_correlation_strength_matrix.py
   Tests: Strength values, penalties, emoji, full parlay analysis

ğŸ“„ scripts/analysis/correlation_calibration_tracker.py
   âœ… NEW - Post-betting analysis and tuning
   Use: After each week to validate strength values

ğŸ“„ PROJECT_3_IMPROVEMENT_1_INTEGRATION.md
   âœ… NEW - Complete integration guide
   Read: Full technical details and troubleshooting

ğŸ“„ PROJECT_3_IMPROVEMENT_1_COMPLETE.md
   âœ… NEW - Implementation summary and next steps
   Read: Overview, workflow, and success criteria

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
QUICK TEST (RUN THIS FIRST)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

$ cd C:\Users\scott\Desktop\nfl-betting-systemv2
$ python test_correlation_strength_matrix.py

âœ… All tests pass? â†’ Ready for integration
âŒ Tests fail? â†’ Check PROJECT_3_IMPROVEMENT_1_INTEGRATION.md troubleshooting

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
INTEGRATION CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¡ Step 1: Run test suite
  Command: python test_correlation_strength_matrix.py
  Expected: 5 tests, all âœ“

â–¡ Step 2: Verify penalty calculations
  Test 2 should show:
    DVOA+Matchup = -7.5% (not -10%)
    Volume+Trend = -3.5% (not -10%)

â–¡ Step 3: Test with sample parlay
  Create 3-leg parlay with mixed correlations
  Verify penalties are reasonable

â–¡ Step 4: Integrate into betting CLI
  Use EnhancedParlayBuilder instead of basic ParlayBuilder
  Test parlay generation

â–¡ Step 5: Start tracking results
  Begin using calibration_tracker for weekly analysis

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
THE FORMULA (Simplified)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

For each pair of legs in parlay:
  1. Identify shared drivers (agents driving both legs)
  2. Look up correlation strength for that driver pair
  3. Calculate: penalty = -5.0 * strength
  4. Apply penalty to parlay confidence
  5. Display warning with emoji indicator

Example:
  Leg 1: DVOA=40%, Matchup=30% (drivers: DVOA, Matchup)
  Leg 2: DVOA=35%, Volume=32% (drivers: DVOA, Volume)
  
  Shared driver pair: DVOA + Matchup â†’ strength 1.5
  Penalty: -5.0 * 1.5 = -7.5%
  Warning: ğŸ”¥ Both legs driven by DVOA + Matchup

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STRENGTH VALUES AT A GLANCE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1.5 = DVOA + Matchup         (both measuring same weakness â†’ very correlated)
1.3 = DVOA + GameScript      (game flow from weak defense)
1.2 = Matchup + GameScript   (matchup context affects script)
1.1 = Injury + Volume        (injury directly affects usage)
1.0 = DVOA + Volume          (baseline/moderate correlation)
0.9 = Injury + Matchup       (injury affects matchup value)
0.7 = Trend + Volume         (different signal types)
0.6 = Trend + Injury         (performance vs health)
0.5 = Variance + Weather     (minimal overlap)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CALIBRATION WORKFLOW (After Betting)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

EACH SUNDAY (Results Available):
  1. Log parlay results with calibration tracker
  2. Note which correlations were present
  3. Result: WIN, LOSS, PUSH, PARTIAL

AFTER 3-4 WEEKS (Enough Data):
  1. Run: tracker.analyze_by_correlation_type()
  2. Compare actual loss rates to expected rates
  3. Look for correlations off by 15%+ 
  4. Review: tracker.recommend_adjustments()
  5. Update strength values if recommendations appear
  6. Document why you made each adjustment

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PROBLEM: Tests fail
  â†’ Check correlation_detector.py is in scripts/analysis/
  â†’ Verify all imports work (run: python -c "from scripts.analysis...")

PROBLEM: Penalties seem too harsh
  â†’ Is the calibration tracker showing high loss rates?
  â†’ If actual losses < expected â†’ adjust strength DOWN
  â†’ If actual losses > expected â†’ adjust strength UP

PROBLEM: No correlations detected
  â†’ Check that top_contributing_agents is populated
  â†’ Verify agent names match exactly (DVOA not dvoa)
  â†’ Run debug_agents.py to verify agent scores

PROBLEM: Parlay confidence drops too much
  â†’ Check max_correlation_penalty parameter (-20.0 default)
  â†’ Reduce if being too conservative
  â†’ Increase if missing real risks

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
EMOJI MEANINGS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”¥ = VERY STRONG correlation (strength 1.3+)
   â†’ Major red flag, serious redundancy
   â†’ Example: DVOA + Matchup (both signal same weakness)
   â†’ Action: Consider avoiding or reducing bet size

âš ï¸ = MODERATE correlation (strength 0.9-1.2)
   â†’ Caution warranted, some redundancy
   â†’ Example: DVOA + Volume (related but partly independent)
   â†’ Action: Reasonable to include, note the risk

âš¡ = WEAK correlation (strength 0.5-0.8)
   â†’ Minor concern, mostly independent
   â†’ Example: Trend + Volume (different signal types)
   â†’ Action: Include freely, risk is minimal

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
NEXT STEPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

THIS WEEK:
  âœ“ Run test suite
  âœ“ Verify all tests pass
  âœ“ Integrate into betting system
  âœ“ Generate test parlays

NEXT WEEK:
  âœ“ Start betting with new system
  âœ“ Begin tracking results with calibration_tracker

AFTER 4 WEEKS:
  âœ“ Analyze correlation accuracy
  âœ“ Make strength adjustments if needed
  âœ“ Document calibration changes

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Questions? See:
  - PROJECT_3_IMPROVEMENT_1_INTEGRATION.md (full guide)
  - PROJECT_3_IMPROVEMENT_1_COMPLETE.md (overview)
  - Correlation tracking: scripts/analysis/correlation_calibration_tracker.py

Version: 1.0 (November 2025)
Status: âœ… Ready for Testing & Integration
